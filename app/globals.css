/* /app/globals.css */

/*
  Global design goals:
  - Documentation/textbook feel: readable line length, calm palette, structured cards.
  - Mobile-first, responsive sidebar (off-canvas on small screens).
  - Accessibility-first: visible focus, skip links, good contrast, reduced motion support.
  - Math-friendly: KaTeX + MathJax overflow handling.
*/

/* Optional: Use cascade layers to keep specificity predictable. */
@layer reset, base, layout, components, utilities;

/* ---------------------------------------------
   RESET
---------------------------------------------- */
@layer reset {
  *,
  *::before,
  *::after {
    box-sizing: border-box;
  }

  html {
    -webkit-text-size-adjust: 100%;
    text-size-adjust: 100%;
    scroll-behavior: smooth;
  }

  body {
    margin: 0;
    min-height: 100dvh;
  }

  img,
  picture,
  video,
  canvas,
  svg {
    display: block;
    max-width: 100%;
  }

  input,
  button,
  textarea,
  select {
    font: inherit;
    color: inherit;
  }

  /* Prevent long URLs / math tokens from blowing up layouts */
  p,
  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    overflow-wrap: break-word;
  }
}

/* ---------------------------------------------
   TOKENS + BASE
---------------------------------------------- */
@layer base {
  :root {
    /* Let the UA render controls appropriately in light/dark (scrollbars, form controls). */
    color-scheme: light dark;

    /* Layout */
    --topbar-h: 56px;
    --sidebar-w: 280px;

    /* Type */
    --font-sans: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial, "Apple Color Emoji",
      "Segoe UI Emoji", "Segoe UI Symbol";
    --font-mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New",
      monospace;

    /* Sizing / spacing */
    --radius-1: 8px;
    --radius-2: 12px;
    --radius-round: 999px;

    --space-1: 0.25rem;
    --space-2: 0.5rem;
    --space-3: 0.75rem;
    --space-4: 1rem;
    --space-5: 1.25rem;
    --space-6: 1.5rem;
    --space-7: 2rem;
    --space-8: 2.5rem;

    /* Readability */
    --content-max: 80ch;     /* primary readable line length */
    --page-max: 1180px;      /* max width of content area */

    /* Shadows (subtle) */
    --shadow-1: 0 1px 2px rgb(0 0 0 / 0.06), 0 4px 16px rgb(0 0 0 / 0.06);
    --shadow-2: 0 2px 6px rgb(0 0 0 / 0.10), 0 12px 28px rgb(0 0 0 / 0.14);

    /* Light theme colors (neutral academic) */
    --bg: #f8fafc;
    --surface: #ffffff;
    --surface-2: #f1f5f9;
    --surface-3: #e2e8f0;

    --text: #0f172a;
    --text-muted: #334155;

    --border: #e2e8f0;

    --brand: #2563eb;        /* blue */
    --brand-2: #1d4ed8;
    --brand-contrast: #ffffff;

    --focus: color-mix(in srgb, var(--brand) 70%, white);
    --danger: #b91c1c;

    /* Link defaults */
    --link: var(--brand-2);
    --link-hover: #1e40af;

    /* Code / pre */
    --code-bg: #0b1220;
    --code-text: #e5e7eb;
  }

  @media (prefers-color-scheme: dark) {
    :root {
      --bg: #0b1220;
      --surface: #0f172a;
      --surface-2: #111c33;
      --surface-3: #172554;

      --text: #e5e7eb;
      --text-muted: #cbd5e1;

      --border: #1e293b;

      --brand: #60a5fa;
      --brand-2: #93c5fd;
      --brand-contrast: #0b1220;

      --link: #93c5fd;
      --link-hover: #bfdbfe;

      --code-bg: #030712;
      --code-text: #e5e7eb;

      --shadow-1: 0 1px 2px rgb(0 0 0 / 0.35), 0 10px 30px rgb(0 0 0 / 0.25);
      --shadow-2: 0 2px 10px rgb(0 0 0 / 0.40), 0 24px 50px rgb(0 0 0 / 0.35);
    }
  }

  /* Optional manual overrides (if you later add a theme toggle):
     <html data-theme="dark"> or <html data-theme="light"> */
  html[data-theme="light"] {
    color-scheme: light;
  }
  html[data-theme="dark"] {
    color-scheme: dark;
  }

  body {
    font-family: var(--font-sans);
    color: var(--text);
    background: var(--bg);
    line-height: 1.7;
  }

  a {
    color: var(--link);
    text-decoration: underline;
    text-decoration-thickness: 1px;
    text-underline-offset: 3px;
  }

  a:hover {
    color: var(--link-hover);
  }

  /* Focus styling: Intentional, visible, and not “outline: none”.
     :focus-visible respects modality (keyboard vs mouse). */
  :focus-visible {
    outline: 3px solid var(--focus);
    outline-offset: 3px;
    border-radius: 6px;
  }

  /* Typography scale */
  h1,
  h2,
  h3 {
    line-height: 1.2;
    letter-spacing: -0.015em;
    margin: 0 0 var(--space-4);
  }

  h1 {
    font-size: clamp(1.8rem, 2.4vw, 2.5rem);
    font-weight: 750;
  }

  h2 {
    font-size: clamp(1.35rem, 1.6vw, 1.8rem);
    font-weight: 700;
    margin-top: var(--space-8);
  }

  h3 {
    font-size: clamp(1.1rem, 1.2vw, 1.25rem);
    font-weight: 650;
    margin-top: var(--space-6);
  }

  p {
    margin: 0 0 var(--space-4);
    color: var(--text);
  }

  small,
  .muted {
    color: var(--text-muted);
  }

  hr {
    border: none;
    border-top: 1px solid var(--border);
    margin: var(--space-8) 0;
  }

  code,
  pre {
    font-family: var(--font-mono);
    font-size: 0.95em;
  }

  pre {
    background: var(--code-bg);
    color: var(--code-text);
    padding: var(--space-5);
    border-radius: var(--radius-2);
    overflow: auto;
    box-shadow: var(--shadow-1);
  }

  code {
    background: color-mix(in srgb, var(--surface-2) 70%, transparent);
    padding: 0.15em 0.35em;
    border-radius: 6px;
  }

  /* Skip link (hidden until focused) */
  .skip-link {
    position: absolute;
    top: var(--space-3);
    left: var(--space-3);
    z-index: 1000;
    padding: var(--space-2) var(--space-4);
    background: var(--surface);
    color: var(--text);
    border: 1px solid var(--border);
    border-radius: var(--radius-2);
    box-shadow: var(--shadow-2);
    transform: translateY(-200%);
    transition: transform 150ms ease;
    text-decoration: none;
  }

  .skip-link:focus-visible {
    transform: translateY(0);
  }

  /* Reduce motion preferences */
  @media (prefers-reduced-motion: reduce) {
    html {
      scroll-behavior: auto;
    }
    *,
    *::before,
    *::after {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
    }
  }
}

/* ---------------------------------------------
   LAYOUT: Topbar + Sidebar + Main
---------------------------------------------- */
@layer layout {
  .app-shell {
    min-height: 100dvh;
    display: grid;
    grid-template-columns: var(--sidebar-w) minmax(0, 1fr);
    grid-template-rows: var(--topbar-h) 1fr;
    grid-template-areas:
      "topbar topbar"
      "sidebar main";
  }

  .topbar {
    grid-area: topbar;
    position: sticky;
    top: 0;
    z-index: 50;
    background: color-mix(in srgb, var(--surface) 92%, transparent);
    backdrop-filter: blur(10px);
    border-bottom: 1px solid var(--border);
  }

  .topbar__inner {
    height: var(--topbar-h);
    max-width: var(--page-max);
    margin: 0 auto;
    padding: 0 var(--space-5);
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--space-4);
  }

  .brand {
    display: inline-flex;
    align-items: center;
    gap: var(--space-2);
    font-weight: 800;
    letter-spacing: -0.02em;
    color: var(--text);
    text-decoration: none;
  }

  .brand:hover {
    color: var(--text);
    text-decoration: underline;
    text-decoration-thickness: 2px;
  }

  .topbar__menuButton {
    display: none; /* shown on mobile */
    border: 1px solid var(--border);
    background: var(--surface);
    color: var(--text);
    border-radius: var(--radius-1);
    padding: var(--space-2) var(--space-3);
    box-shadow: var(--shadow-1);
    cursor: pointer;
  }

  .sidebar {
    grid-area: sidebar;
    position: sticky;
    top: var(--topbar-h);
    height: calc(100dvh - var(--topbar-h));
    overflow: auto;
    border-right: 1px solid var(--border);
    background: var(--surface);
    padding: var(--space-5);
  }

  .sidebar__nav {
    width: 100%;
  }

  .sidebar__list {
    list-style: none;
    padding: 0;
    margin: 0;
    display: grid;
    gap: var(--space-2);
  }

  .sidebar__link {
    display: block;
    padding: var(--space-2) var(--space-3);
    border-radius: var(--radius-1);
    text-decoration: none;
    color: var(--text);
    border: 1px solid transparent;
  }

  .sidebar__link:hover {
    background: var(--surface-2);
    border-color: var(--border);
  }

  .sidebar__link[aria-current="page"] {
    background: color-mix(in srgb, var(--brand) 16%, var(--surface));
    border-color: color-mix(in srgb, var(--brand) 35%, var(--border));
    font-weight: 700;
  }

  .sidebar-overlay {
    display: none;
  }

  .main {
    grid-area: main;
    padding: var(--space-7) var(--space-6);
  }

  .container {
    max-width: var(--page-max);
    margin: 0 auto;
  }

  .prose {
    max-width: var(--content-max);
  }

  /* Responsive: collapse sidebar into off-canvas. */
  @media (max-width: 920px) {
    .app-shell {
      grid-template-columns: 1fr;
      grid-template-rows: var(--topbar-h) 1fr;
      grid-template-areas:
        "topbar"
        "main";
    }

    .topbar__menuButton {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      min-width: 44px;
      min-height: 44px;
    }

    .sidebar {
      position: fixed;
      inset: var(--topbar-h) auto 0 0;
      width: min(var(--sidebar-w), 88vw);
      height: calc(100dvh - var(--topbar-h));
      transform: translateX(-105%);
      transition: transform 180ms ease;
      box-shadow: var(--shadow-2);
      z-index: 60;
    }

    .sidebar[data-open="true"] {
      transform: translateX(0);
    }

    .sidebar-overlay {
      display: block;
      position: fixed;
      inset: var(--topbar-h) 0 0 0;
      border: 0;
      padding: 0;
      margin: 0;
      background: rgb(0 0 0 / 0.28);
      opacity: 0;
      pointer-events: none;
      transition: opacity 180ms ease;
      z-index: 55;
    }

    .sidebar-overlay[data-open="true"] {
      opacity: 1;
      pointer-events: auto;
    }

    /* Reduce motion on mobile menu for users who request it */
    @media (prefers-reduced-motion: reduce) {
      .sidebar,
      .sidebar-overlay {
        transition: none;
      }
    }
  }
}

/* ---------------------------------------------
   COMPONENTS: Cards, theorem/proof, tables, buttons
---------------------------------------------- */
@layer components {
  .card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius-2);
    box-shadow: var(--shadow-1);
    padding: var(--space-6);
  }

  .card + .card {
    margin-top: var(--space-6);
  }

  .card--theorem {
    border-left: 4px solid var(--brand);
    padding-left: calc(var(--space-6) - 4px);
  }

  .card--proof {
    background: var(--surface-2);
  }

  .btn {
    appearance: none;
    border: 1px solid var(--border);
    background: var(--surface);
    color: var(--text);
    border-radius: var(--radius-1);
    padding: 0.6rem 0.9rem;
    cursor: pointer;
    box-shadow: var(--shadow-1);
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    gap: var(--space-2);
  }

  .btn:hover {
    border-color: color-mix(in srgb, var(--brand) 35%, var(--border));
    background: var(--surface-2);
  }

  .btn--primary {
    background: var(--brand);
    color: var(--brand-contrast);
    border-color: color-mix(in srgb, var(--brand) 60%, var(--border));
  }

  .btn--primary:hover {
    background: var(--brand-2);
  }

  /* Tables */
  .table-wrap {
    overflow-x: auto;
    border: 1px solid var(--border);
    border-radius: var(--radius-2);
    background: var(--surface);
  }

  table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.98rem;
  }

  th,
  td {
    text-align: left;
    padding: var(--space-3) var(--space-4);
    border-bottom: 1px solid var(--border);
    vertical-align: top;
  }

  th {
    font-weight: 750;
    background: var(--surface-2);
  }

  /* Footer */
  .footer {
    border-top: 1px solid var(--border);
    background: var(--surface);
    padding: var(--space-7) 0;
  }

  .footer__inner {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0 var(--space-5);
    color: var(--text-muted);
  }

  /* Screen-reader-only utility */
  .sr-only {
    position: absolute !important;
    width: 1px !important;
    height: 1px !important;
    padding: 0 !important;
    margin: -1px !important;
    overflow: hidden !important;
    clip: rect(0, 0, 0, 0) !important;
    white-space: nowrap !important;
    border: 0 !important;
  }
  /* ---------------------------------------------
   Homepage – Curriculum Style Layout
---------------------------------------------- */

.home_card {
  display: block;
  padding: var(--space-8) var(--space-6);
  border-radius: 14px;
  background: color-mix(in srgb, var(--surface) 92%, var(--brand) 8%);
  border: 1px solid color-mix(in srgb, var(--border) 85%, var(--brand) 15%);
  transition: background 150ms ease, transform 150ms ease;
  text-decoration: none;
  color: inherit;
}

.home_card:hover {
  background: color-mix(in srgb, var(--surface) 85%, var(--brand) 15%);
  transform: translateY(-4px);
}

.home_card_inner {
  max-width: 75ch;
}

.home_card_title {
  font-size: 1.4rem;
  font-weight: 750;
  letter-spacing: -0.02em;
  margin-bottom: var(--space-3);
}

.home_card_description {
  color: var(--text-muted);
  line-height: 1.6;
  margin: 0;
}

/* Homepage container layout */

.main_info {
  max-width: 900px;
  margin: 0 auto;
  padding: var(--space-8) var(--space-6);
}

.main_header {
  margin-bottom: var(--space-4);
}

.main_par {
  max-width: 75ch;
  margin-bottom: var(--space-8);
  color: var(--text-muted);
}

.mapped_cards {
  display: flex;
  flex-direction: column;
}
/* ---------------------------------------------
   Section Cards – Refined Academic Design
---------------------------------------------- */

/* ---------------------------------------------
   Section Rows – Academic Curriculum Style
---------------------------------------------- */

.section_card {
  display: block;
  padding: var(--space-8) var(--space-4);
  border-left: 4px solid transparent;
  border-bottom: 1px solid var(--border);

  text-decoration: none;
  color: inherit;

  transition: 
    background 150ms ease,
    border-left-color 150ms ease,
    padding-left 150ms ease;
}

.section_card:hover {
  background: var(--surface-2);
  border-left-color: var(--brand);
  padding-left: calc(var(--space-4) + 6px);
}

.section_card_inner {
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.section_card_title {
  font-size: 1.45rem;
  font-weight: 750;
  letter-spacing: -0.02em;
  margin: 0;
  color: var(--text);
}

  /* -----------------------------
     KaTeX / MathJax compatibility
  ------------------------------ */

  /* KaTeX: make display equations scroll horizontally without vertical scrollbar. */
  .katex-display {
    overflow: auto hidden;
    padding-bottom: 0.25rem;
    margin: 0.75rem 0;
  }

  /* Guardrails for long math in narrow mobile layouts */
  .katex {
    max-width: 100%;
  }

  /* MathJax containers (common patterns) */
  .MathJax,
  mjx-container {
    max-width: 100%;
    overflow-x: auto;
    overflow-y: hidden;
  }

  /* -----------------------------
     Back-compat for current class names
     (lets you migrate components gradually)
  ------------------------------ */

  .header-sec {
    /* map to topbar visuals */
    background: color-mix(in srgb, var(--surface) 92%, transparent);
    border-bottom: 1px solid var(--border);
  }

  .nav-link {
    color: inherit;
    text-decoration: none;
  }

  .nav-link:hover {
    text-decoration: underline;
    text-decoration-thickness: 2px;
  }

  .proof_container {
    display: flex;
    justify-content: center;
    width: 100%;
  }

  .proof_card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius-2);
    box-shadow: var(--shadow-1);
    width: min(980px, 100%);
    padding: var(--space-6);
    min-height: 60vh;
  }

  .button-sec {
    margin-top: var(--space-6);
    display: flex;
    justify-content: space-between;
    gap: var(--space-3);
  }

  .sec_btn,
  .sec_btn2 {
    /* map old buttons to new button look */
    appearance: none;
    border: 1px solid var(--border);
    background: var(--brand);
    color: var(--brand-contrast);
    border-radius: var(--radius-1);
    padding: 0.6rem 0.9rem;
    cursor: pointer;
    box-shadow: var(--shadow-1);
  }

  .sec_btn:hover,
  .sec_btn2:hover {
    background: var(--brand-2);
  }

  .proof {
    display: grid;
    gap: var(--space-4);
  }

  .proof_name {
    margin: 0;
  }

  .theorem {
    background: var(--surface);
    border: 1px solid var(--border);
    border-left: 4px solid var(--brand);
    border-radius: var(--radius-2);
    padding: var(--space-5);
    box-shadow: var(--shadow-1);
  }

  .proof_content {
    background: var(--surface-2);
    border: 1px solid var(--border);
    border-radius: var(--radius-2);
    padding: var(--space-6);
  }
}
